{% extends "base.html" %}

{% block title %}Create Teacher - NanaPatha{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-6">
    <!-- Page Header -->
    <div class="flex items-center space-x-4">
        <a href="{{ url_for('admin_teachers') }}" 
           class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors duration-150">
            <i class="fas fa-arrow-left"></i>
        </a>
        
        <div>
            <h1 class="text-2xl font-semibold text-gray-900">Add New Teacher</h1>
            <p class="text-sm text-gray-500 mt-1">Create a new teacher account and profile</p>
        </div>
    </div>

    <!-- Teacher Creation Form -->
    <div class="bg-white rounded-lg shadow p-8">
        <form method="POST" class="space-y-8" enctype="multipart/form-data">
            <!-- Basic Information -->
            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-user text-brand mr-2"></i>
                    Basic Information
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Full Name -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Full Name <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="name" required
                               placeholder="Enter teacher's full name" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Email -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Email Address <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="email" required
                               placeholder="teacher@example.com" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Phone -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Phone Number <span class="text-red-500">*</span>
                        </label>
                        <input type="tel" name="phone" required
                               placeholder="+94 XX XXX XXXX" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Professional Information -->
            <div class="border-t pt-8">
                <h3 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-chalkboard-teacher text-brand mr-2"></i>
                    Professional Details
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Subject Specialization -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Subject Specialization <span class="text-red-500">*</span>
                        </label>
                        <select name="subject_specialization" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                            <option value="">Select Subject</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="Physics">Physics</option>
                            <option value="Chemistry">Chemistry</option>
                            <option value="Biology">Biology</option>
                            <option value="English">English</option>
                            <option value="Sinhala">Sinhala</option>
                            <option value="Tamil">Tamil</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Economics">Economics</option>
                            <option value="Business Studies">Business Studies</option>
                            <option value="Accounting">Accounting</option>
                            <option value="ICT">ICT</option>
                            <option value="Art">Art</option>
                            <option value="Music">Music</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <!-- Experience Years -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Years of Experience
                        </label>
                        <input type="number" name="experience_years" min="0" max="50"
                               placeholder="Years of teaching experience" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Qualifications -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Qualifications
                        </label>
                        <input type="text" name="qualifications"
                               placeholder="e.g., B.Sc. Mathematics, M.Ed." 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Previous Institution -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Previous Institution
                        </label>
                        <input type="text" name="previous_institution"
                               placeholder="Previous school/institution" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Employee ID -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Employee ID
                        </label>
                        <input type="text" name="employee_id"
                               placeholder="Auto-generated if empty" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                        <p class="text-xs text-gray-500 mt-1">Leave empty to auto-generate</p>
                    </div>
                </div>
                
                <!-- Bio -->
                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Bio / Teaching Philosophy
                    </label>
                    <textarea name="bio" rows="3"
                              placeholder="Brief description about the teacher's background and teaching approach" 
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent"></textarea>
                </div>
            </div>

            <!-- Contact & Emergency Information -->
            <div class="border-t pt-8">
                <h3 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-address-card text-brand mr-2"></i>
                    Contact Information
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Emergency Contact Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Emergency Contact Name
                        </label>
                        <input type="text" name="emergency_contact_name"
                               placeholder="Emergency contact person" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Emergency Contact Phone -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Emergency Contact Phone
                        </label>
                        <input type="tel" name="emergency_contact_phone"
                               placeholder="+94 XX XXX XXXX" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- NIC Number -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            NIC Number
                        </label>
                        <input type="text" name="nic_number"
                               placeholder="National Identity Card Number" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Date of Birth -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Date of Birth
                        </label>
                        <input type="date" name="date_of_birth"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Address Information -->
            <div class="border-t pt-8">
                <h3 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-map-marker-alt text-brand mr-2"></i>
                    Address Information
                </h3>
                
                <div class="space-y-4">
                    <!-- Address Line 1 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Address Line 1
                        </label>
                        <input type="text" name="address_line1"
                               placeholder="House number and street name" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- City -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                City
                            </label>
                            <input type="text" name="city"
                                   placeholder="City" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                        </div>
                        
                        <!-- District -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                District
                            </label>
                            <input type="text" name="district"
                                   placeholder="District" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                        </div>
                        
                        <!-- Postal Code -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Postal Code
                            </label>
                            <input type="text" name="postal_code"
                                   placeholder="00000" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Employment Details -->
            <div class="border-t pt-8">
                <h3 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-briefcase text-brand mr-2"></i>
                    Employment Details
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Join Date -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Join Date
                        </label>
                        <input type="date" name="join_date" value="{{ today }}"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Employment Type -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Employment Type
                        </label>
                        <select name="employment_type"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                            <option value="full-time">Full Time</option>
                            <option value="part-time">Part Time</option>
                            <option value="contract">Contract</option>
                            <option value="substitute">Substitute</option>
                        </select>
                    </div>
                    
                    <!-- Salary -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Monthly Salary (LKR)
                        </label>
                        <input type="number" name="salary" min="0" step="1000"
                               placeholder="Monthly salary amount" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                    </div>
                    
                    <!-- Account Status -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Account Status
                        </label>
                        <select name="status"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="pending">Pending</option>
                        </select>
                    </div>
                </div>
                
                <!-- Batch Assignments -->
                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Initial Batch Assignment (Optional)
                    </label>
                    <select name="batch_id" multiple
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand focus:border-transparent">
                        {% for batch in batches %}
                            <option value="{{ batch.id }}">{{ batch.name }} - {{ batch.subject }}</option>
                        {% endfor %}
                    </select>
                    <p class="text-xs text-gray-500 mt-1">Hold Ctrl/Cmd to select multiple batches. Can be modified later.</p>
                </div>
                
                <!-- Send Welcome Email -->
                <div class="mt-6">
                    <label class="flex items-center">
                        <input type="checkbox" name="send_welcome_email" checked
                               class="w-4 h-4 text-brand border-gray-300 rounded focus:ring-brand">
                        <span class="ml-2 text-sm text-gray-700">
                            Send welcome email with login credentials
                        </span>
                    </label>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="border-t pt-8 flex items-center justify-end space-x-4">
                <a href="{{ url_for('admin_teachers') }}" 
                   class="px-6 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150">
                    Cancel
                </a>
                
                <button type="submit" 
                        class="px-6 py-2 text-sm font-medium text-white bg-brand rounded-md hover:bg-brand-700 transition-colors duration-150">
                    <i class="fas fa-save mr-2"></i>
                    Create Teacher
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Auto-generate employee ID based on name and subject
document.addEventListener('DOMContentLoaded', function() {
    const nameInput = document.querySelector('input[name="name"]');
    const subjectSelect = document.querySelector('select[name="subject_specialization"]');
    const employeeIdInput = document.querySelector('input[name="employee_id"]');
    
    function generateEmployeeId() {
        if (employeeIdInput.value.trim() === '' && nameInput.value && subjectSelect.value) {
            const initials = nameInput.value.split(' ')
                .map(word => word.charAt(0).toUpperCase())
                .join('');
            const subjectCode = subjectSelect.value.substring(0, 3).toUpperCase();
            const year = new Date().getFullYear();
            const random = Math.floor(Math.random() * 100).toString().padStart(2, '0');
            
            employeeIdInput.placeholder = `T${year}${subjectCode}${initials}${random}`;
        }
    }
    
    nameInput.addEventListener('input', generateEmployeeId);
    subjectSelect.addEventListener('change', generateEmployeeId);
});
</script>
{% endblock %}